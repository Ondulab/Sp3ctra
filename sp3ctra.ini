# Sp3ctra Configuration
# This file is the single source of truth for all parameter values, ranges, and MIDI scaling
# MIDI mappings (CC/NOTE assignments) are defined in midi_mapping.ini
# Modify these values as needed - the program will validate them on startup

#==============================================================================
# SYSTEM CONFIGURATION
#==============================================================================

# Global log level: ERROR, WARNING, INFO, DEBUG
Log_level = DEBUG

#==============================================================================
# AUDIO SYSTEM (Real-Time Critical)
#==============================================================================

[audio]
# Audio system configuration - optimized for real-time synthesis
# Sampling frequency in Hz (48000, 96000)
sampling_frequency = 96000

# Audio buffer size in frames - affects latency and stability
# Smaller values = lower latency, larger values = more stable
audio_buffer_size = 256

[audio_global]
# Master output volume (0.0-1.0)
master_volume = 1.0
master_volume_min = 0.0
master_volume_max = 1.0
master_volume_scaling = linear

# Reverb Parameters
reverb_mix = 0.5
reverb_mix_min = 0.0
reverb_mix_max = 1.0
reverb_mix_scaling = linear

reverb_size = 0.5
reverb_size_min = 0.0
reverb_size_max = 1.0
reverb_size_scaling = linear

reverb_damp = 0.5
reverb_damp_min = 0.0
reverb_damp_max = 1.0
reverb_damp_scaling = linear

reverb_width = 1.0
reverb_width_min = 0.0
reverb_width_max = 1.0
reverb_width_scaling = linear

# EQ Parameters
eq_low_gain = 0.0
eq_low_gain_min = -12.0
eq_low_gain_max = 12.0
eq_low_gain_scaling = linear

eq_mid_gain = 0.0
eq_mid_gain_min = -12.0
eq_mid_gain_max = 12.0
eq_mid_gain_scaling = linear

eq_high_gain = 0.0
eq_high_gain_min = -12.0
eq_high_gain_max = 12.0
eq_high_gain_scaling = linear

eq_mid_freq = 1000.0
eq_mid_freq_min = 200.0
eq_mid_freq_max = 5000.0
eq_mid_freq_scaling = logarithmic

[auto_volume]
# IMU-based automatic volume control
# Enable/disable auto-volume (0=disabled, 1=enabled)
auto_volume_enabled = 0

# Timeout before switching to inactive mode (seconds)
imu_inactivity_timeout_s = 5

# Volume level when inactive (0.0-1.0)
auto_volume_inactive_level = 0.010

# Fade duration for volume transitions (ms)
auto_volume_fade_ms = 600

#==============================================================================
# INSTRUMENT CONFIGURATION (Hardware)
#==============================================================================

[instrument]
# Sensor hardware configuration
# The system will automatically calculate the optimal resolution based on DPI
# Sensor resolution: 200 or 400 DPI
sensor_dpi = 400

#==============================================================================
# IMAGE PROCESSING CONFIGURATION (Per-Synthesis)
#==============================================================================

[image_processing_additive]
# Additive synthesis image processing pipeline
# Pipeline: RGB → Grayscale → Inversion → Gamma → Averaging → Contrast

# Pixel Intensity Behavior (0=bright pixels louder, 1=dark pixels louder)
invert_intensity = 1

# Non-Linear Intensity Mapping (Gamma Correction)
# Enable/disable gamma correction (0/1)
enable_non_linear_mapping = 1
# Gamma exponent (0.1-10.0, default 4.8)
gamma_value = 4.8

# Contrast Modulation
# Minimum volume for blurred images (0.0-1.0)
contrast_min = 0.21
# Pixel sampling stride for optimization
contrast_stride = 1.0
# Exponent for contrast curve adjustment
contrast_adjustment_power = 0.5

[image_processing_polyphonic]
# Polyphonic synthesis image processing pipeline
# Pipeline: RGB → Grayscale → Inversion → FFT (NO gamma for linear response)
# Note: amplitude_gamma is applied AFTER FFT on magnitudes (see [polyphonic] section)

[image_processing_photowave]
# Photowave synthesis uses native RGB sampling
# No preprocessing pipeline - direct RGB copy for waveform generation

#==============================================================================
# ADDITIVE SYNTHESIS PARAMETERS
#==============================================================================

[synth_additive]

# Musical Frequency Mapping (Additive-Specific)
# These values define the musical range that will be mapped across the sensor
# Starting frequency in Hz (C2)
low_frequency = 65.41
# Ending frequency in Hz (~8 octaves above)
high_frequency = 16744.04

# Threading Configuration
# Number of worker threads for parallel processing (1-8)
# Default: 3 (optimized for Raspberry Pi 5 with 4 cores)
# Higher values may improve performance on systems with more cores
num_workers = 8

# Mix level for additive synthesis (0.0-1.0)
volume = 1.0
volume_min = 0.0
volume_max = 1.0
volume_scaling = linear

# Reverb send amount (0.0-1.0)
reverb_send = 0.0
reverb_send_min = 0.0
reverb_send_max = 1.0
reverb_send_scaling = linear

# Envelope Parameters (MIDI-controllable)
# Base time constants for envelope slew (multiplied by runtime divisors)
envelope_tau_up_base_ms = 0.5
envelope_tau_up_base_ms_min = 0.001
envelope_tau_up_base_ms_max = 1000.0
envelope_tau_up_base_ms_scaling = exponential

envelope_tau_down_base_ms = 0.5
envelope_tau_down_base_ms_min = 0.001
envelope_tau_down_base_ms_max = 10000.0
envelope_tau_down_base_ms_scaling = exponential

# Frequency-dependent release weighting (stabilizes highs vs lows)
envelope_decay_freq_ref_hz = 440.0
envelope_decay_freq_ref_hz_min = 20.0
envelope_decay_freq_ref_hz_max = 20000.0
envelope_decay_freq_ref_hz_scaling = logarithmic

envelope_decay_freq_beta = -1.2
envelope_decay_freq_beta_min = -5.0
envelope_decay_freq_beta_max = 5.0
envelope_decay_freq_beta_scaling = linear

# Stereo Control (MIDI-controllable)
# Enable/disable stereo mode (0=mono, 1=stereo)
stereo_mode_enabled = 1
stereo_mode_enabled_min = 0.0
stereo_mode_enabled_max = 1.0
stereo_mode_enabled_scaling = discrete

[envelope_slew]
# DEPRECATED: These parameters have been moved to [synth_additive] for MIDI control
# Kept for backward compatibility with config_loader
# Base time constants for envelope slew (multiplied by runtime divisors)
tau_up_base_ms = 0.5
tau_down_base_ms = 0.5
decay_freq_ref_hz = 440.0
decay_freq_beta = -1.2

[stereo_processing]
# DEPRECATED: stereo_mode_enabled moved to [synth_additive] for MIDI control
# Kept for backward compatibility with config_loader
# Stereo imaging based on color temperature
stereo_mode_enabled = 1

# Controls global stereo intensity
stereo_temperature_amplification = 2.5

# Balance between color axes
stereo_blue_red_weight = 0.8
stereo_cyan_yellow_weight = 0.2

# Shape of response curve
stereo_temperature_curve_exponent = 1.0

[summation_normalization]
# Volume dynamics and compression
# Volume weighting exponent - LOWER values make strong oscillators dominate more
# Valid range: 0.01 to 10.0 (0.1 = strong domination, 1.0 = linear, 2.0+ = flattened)
volume_weighting_exponent = 0.1

# Final response curve exponent - HIGHER values = MORE compression
# Valid range: 0.1 to 3.0 (0.5 = expand, 1.0 = linear, 2.0+ = compress)
summation_response_exponent = 2.0

# Noise Gate Configuration
# Suppresses weak signals (dust, background noise) before compression
# Threshold as fraction of max volume (0.0-0.1)
# Lower values = more permissive, higher values = more aggressive
# Recommended: 0.003-0.01 for optimal noise suppression
# 0.0 = gate disabled (all signals pass through)
noise_gate_threshold = 0.005

#==============================================================================
# POLYPHONIC SYNTHESIS
#==============================================================================

[synth_polyphonic]
# Polyphonic FFT-based synthesis

# ─────────────────────────────────────────────────────────────────────────────
# Voice Configuration
# ─────────────────────────────────────────────────────────────────────────────
# Number of simultaneous polyphonic voices (1-32)
num_voices = 6
num_voices_min = 1
num_voices_max = 32
num_voices_scaling = discrete

# Maximum oscillators per voice (1-256)
max_oscillators = 64
max_oscillators_min = 1
max_oscillators_max = 256
max_oscillators_scaling = discrete

# Master volume for polyphonic mode (0.0-1.0)
master_volume = 0.3
master_volume_min = 0.0
master_volume_max = 1.0
master_volume_scaling = linear

# ─────────────────────────────────────────────────────────────────────────────
# Harmonicity Parameters (Color-Based Timbre Control)
# ─────────────────────────────────────────────────────────────────────────────
# These parameters control how color temperature affects harmonic structure
# Warm colors (red/orange) → harmonic sounds (strings, voice)
# Neutral colors (yellow/green) → semi-harmonic sounds (piano, guitar)
# Cold colors (blue/cyan) → inharmonic sounds (bells, percussion)

# Maximum detune for semi-harmonic sounds in cents (0.0-50.0)
# Used for neutral colors to create piano/guitar-like detuning
detune_max_cents = 30.0
detune_max_cents_min = 0.0
detune_max_cents_max = 50.0
detune_max_cents_scaling = linear

# Harmonicity response curve exponent (0.5-2.0)
# Controls the transition between harmonic and inharmonic behavior
# 1.0 = linear response, <1.0 = more harmonic bias, >1.0 = more inharmonic bias
harmonicity_curve_exponent = 1.5
harmonicity_curve_exponent_min = 0.5
harmonicity_curve_exponent_max = 2.0
harmonicity_curve_exponent_scaling = linear

# ─────────────────────────────────────────────────────────────────────────────
# Harmonic Processing
# ─────────────────────────────────────────────────────────────────────────────
# Minimum audible amplitude threshold (0.0-1.0)
min_audible_amplitude = 0.0001
min_audible_amplitude_min = 0.0
min_audible_amplitude_max = 0.1
min_audible_amplitude_scaling = linear

# Amplitude gamma correction (0.1-5.0)
amplitude_gamma = 1.5
amplitude_gamma_min = 0.1
amplitude_gamma_max = 5.0
amplitude_gamma_scaling = linear

# High frequency harmonic limit in Hz (1000-20000)
high_freq_harmonic_limit_hz = 2000.0
high_freq_harmonic_limit_hz_min = 1000.0
high_freq_harmonic_limit_hz_max = 20000.0
high_freq_harmonic_limit_hz_scaling = linear

# Mix level for polyphonic synthesis (0.0-1.0)
volume = 1.0
volume_min = 0.0
volume_max = 1.0
volume_scaling = linear

# Reverb send amount (0.0-1.0)
reverb_send = 0.0
reverb_send_min = 0.0
reverb_send_max = 1.0
reverb_send_scaling = linear

# Note control (MIDI-triggered)
note_on = 0.0
note_on_min = 0.0
note_on_max = 127.0
note_on_scaling = discrete
note_on_type = button

note_off = 0.0
note_off_min = 0.0
note_off_max = 127.0
note_off_scaling = discrete
note_off_type = button

# Volume ADSR Envelope (MIDI-controllable)
volume_env_attack = 0.01
volume_env_attack_min = 0.001
volume_env_attack_max = 5.0
volume_env_attack_scaling = exponential

volume_env_decay = 0.1
volume_env_decay_min = 0.001
volume_env_decay_max = 5.0
volume_env_decay_scaling = exponential

volume_env_sustain = 0.8
volume_env_sustain_min = 0.0
volume_env_sustain_max = 1.0
volume_env_sustain_scaling = linear

volume_env_release = 0.5
volume_env_release_min = 0.001
volume_env_release_max = 10.0
volume_env_release_scaling = exponential

# Filter ADSR Envelope (MIDI-controllable)
filter_env_attack = 0.02
filter_env_attack_min = 0.001
filter_env_attack_max = 5.0
filter_env_attack_scaling = exponential

filter_env_decay = 0.2
filter_env_decay_min = 0.001
filter_env_decay_max = 5.0
filter_env_decay_scaling = exponential

filter_env_sustain = 0.1
filter_env_sustain_min = 0.0
filter_env_sustain_max = 1.0
filter_env_sustain_scaling = linear

filter_env_release = 0.3
filter_env_release_min = 0.001
filter_env_release_max = 10.0
filter_env_release_scaling = exponential

# LFO Vibrato (MIDI-controllable)
lfo_vibrato_rate = 0.0
lfo_vibrato_rate_min = 0.0
lfo_vibrato_rate_max = 20.0
lfo_vibrato_rate_scaling = linear

lfo_vibrato_depth = 0.0
lfo_vibrato_depth_min = 0.0
lfo_vibrato_depth_max = 2.0
lfo_vibrato_depth_scaling = linear

# Filter Parameters (MIDI-controllable)
filter_cutoff = 8000.0
filter_cutoff_min = 20.0
filter_cutoff_max = 20000.0
filter_cutoff_scaling = logarithmic

filter_env_depth = 0.0
filter_env_depth_min = -10000.0
filter_env_depth_max = 10000.0
filter_env_depth_scaling = linear

#==============================================================================
# PHOTOWAVE SYNTHESIS
#==============================================================================

[synth_photowave]
# Photowave synthesis - transforms image lines into audio waveforms

# Continuous mode: 0=only on MIDI notes, 1=always generating
continuous_mode = 0
continuous_mode_min = 0.0
continuous_mode_max = 1.0
continuous_mode_scaling = discrete

# Scanning mode: 0=Left to Right, 1=Right to Left, 2=Dual (ping-pong)
scan_mode = 0
scan_mode_min = 0.0
scan_mode_max = 2.0
scan_mode_scaling = discrete

# Amplitude (0.0-1.0)
amplitude = 0.20
amplitude_min = 0.0
amplitude_max = 1.0
amplitude_scaling = linear

# Mix level for photowave synthesis (0.0-1.0)
volume = 1.0
volume_min = 0.0
volume_max = 1.0
volume_scaling = linear

# Reverb send amount (0.0-1.0)
reverb_send = 0.0
reverb_send_min = 0.0
reverb_send_max = 1.0
reverb_send_scaling = linear

# Note control (MIDI-triggered)
note_on = 0.0
note_on_min = 0.0
note_on_max = 127.0
note_on_scaling = discrete
note_on_type = button

note_off = 0.0
note_off_min = 0.0
note_off_max = 127.0
note_off_scaling = discrete
note_off_type = button

# Modulation (scan mode control)
modulation = 0.0
modulation_min = 0.0
modulation_max = 127.0
modulation_scaling = discrete

# Resonance (future feature)
resonance = 0.0
resonance_min = 0.0
resonance_max = 1.0
resonance_scaling = linear

# Brightness (interpolation mode)
brightness = 0.0
brightness_min = 0.0
brightness_max = 127.0
brightness_scaling = discrete

# Volume ADSR Envelope
volume_env_attack = 0.01
volume_env_attack_min = 0.001
volume_env_attack_max = 5.0
volume_env_attack_scaling = exponential

volume_env_decay = 0.1
volume_env_decay_min = 0.001
volume_env_decay_max = 5.0
volume_env_decay_scaling = exponential

volume_env_sustain = 0.8
volume_env_sustain_min = 0.0
volume_env_sustain_max = 1.0
volume_env_sustain_scaling = linear

volume_env_release = 0.2
volume_env_release_min = 0.001
volume_env_release_max = 10.0
volume_env_release_scaling = exponential

# Filter ADSR Envelope
filter_env_attack = 0.02
filter_env_attack_min = 0.001
filter_env_attack_max = 5.0
filter_env_attack_scaling = exponential

filter_env_decay = 0.2
filter_env_decay_min = 0.001
filter_env_decay_max = 5.0
filter_env_decay_scaling = exponential

filter_env_sustain = 0.3
filter_env_sustain_min = 0.0
filter_env_sustain_max = 1.0
filter_env_sustain_scaling = linear

filter_env_release = 0.3
filter_env_release_min = 0.001
filter_env_release_max = 10.0
filter_env_release_scaling = exponential

# LFO Vibrato
lfo_vibrato_rate = 0.0
lfo_vibrato_rate_min = 0.0
lfo_vibrato_rate_max = 10.0
lfo_vibrato_rate_scaling = linear

lfo_vibrato_depth = 0.25
lfo_vibrato_depth_min = 0.0
lfo_vibrato_depth_max = 2.0
lfo_vibrato_depth_scaling = linear

# Filter Parameters
filter_cutoff = 8000.0
filter_cutoff_min = 20.0
filter_cutoff_max = 20000.0
filter_cutoff_scaling = logarithmic

filter_env_depth = -0.0
filter_env_depth_min = -10000.0
filter_env_depth_max = 10000.0
filter_env_depth_scaling = linear

#==============================================================================
# SEQUENCER PARAMETERS
#==============================================================================

[sequencer_global]
# Blending mode selector (0=MIX, 1=ADD, 2=SCREEN, 3=MASK)
blend_mode = 3.0
blend_mode_min = 0.0
blend_mode_max = 3.0
blend_mode_scaling = discrete

# Master tempo in BPM
master_tempo = 120.0
master_tempo_min = 40.0
master_tempo_max = 240.0
master_tempo_scaling = linear

# Quantization resolution
quantize_res = 4.0
quantize_res_min = 1.0
quantize_res_max = 16.0
quantize_res_scaling = discrete

[sequencer_player_defaults]
# Default values for all 4 sequencer players
# These are expanded to individual player parameters

# Transport Controls
record_toggle = 0.0
record_toggle_min = 0.0
record_toggle_max = 1.0
record_toggle_scaling = discrete
record_toggle_type = button

play_stop = 0.0
play_stop_min = 0.0
play_stop_max = 1.0
play_stop_scaling = discrete
play_stop_type = button

clear = 0.0
clear_min = 0.0
clear_max = 1.0
clear_scaling = discrete
clear_type = button

# Playback Parameters
speed = 1.0
speed_min = 0.1
speed_max = 4.0
speed_scaling = exponential

exposure = 0.5
exposure_min = 0.0
exposure_max = 1.0
exposure_scaling = linear

offset = 0.0
offset_min = 0.0
offset_max = 1.0
offset_scaling = linear

# ADSR Envelope
env_attack = 0.0
env_attack_min = 0.0
env_attack_max = 1.0
env_attack_scaling = linear

env_decay = 0.0
env_decay_min = 0.0
env_decay_max = 1.0
env_decay_scaling = linear

env_sustain = 1.0
env_sustain_min = 0.0
env_sustain_max = 1.0
env_sustain_scaling = linear

env_release = 0.0
env_release_min = 0.0
env_release_max = 1.0
env_release_scaling = linear

# Loop and Playback
loop_mode = 0.0
loop_mode_min = 0.0
loop_mode_max = 2.0
loop_mode_scaling = discrete

playback_direction = 0.0
playback_direction_min = 0.0
playback_direction_max = 1.0
playback_direction_scaling = discrete

# Image Processing
brightness = 1.0
brightness_min = 0.5
brightness_max = 2.0
brightness_scaling = linear

# Mix Controls
player_mix = 0.0
player_mix_min = 0.0
player_mix_max = 1.0
player_mix_scaling = linear

mix_enabled = 1.0
mix_enabled_min = 0.0
mix_enabled_max = 1.0
mix_enabled_scaling = discrete
mix_enabled_type = button

#==============================================================================
# SYSTEM PARAMETERS
#==============================================================================

[system]
# Freeze synth data
freeze = 0.0
freeze_min = 0.0
freeze_max = 1.0
freeze_scaling = discrete
freeze_type = button

# Resume synth data with fade
resume = 0.0
resume_min = 0.0
resume_max = 1.0
resume_scaling = discrete
resume_type = button
